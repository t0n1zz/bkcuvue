(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{Ll3F:function(t,e,a){"use strict";var s=a("L2JU");function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var n={props:{title:{default:""},titleIcon:{default:""},titleDesc:{default:""},level:{default:1},level2Title:{default:""},level2Route:{default:""}},methods:{level2Back:function(){this.$emit("level2Back")},route1:function(){this.btn1RouteParams?this.$router.push({name:this.btn1Route,params:{cu:this.btn1RouteParams}}):this.$router.push({name:this.btn1Route})},route2:function(){this.btn2RouteParams?this.$router.push({name:this.btn2Route,params:{cu:this.btn2RouteParams}}):this.$router.push({name:this.btn2Route})},route3:function(){this.btn3RouteParams?this.$router.push({name:this.btn3Route,params:{cu:this.btn3RouteParams}}):this.$router.push({name:this.btn3Route})}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(s.b)("auth",{currentUser:"currentUser"}))},l=a("KHd+"),o=Object(l.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-header-content header-elements-md-inline"},[a("div",{staticClass:"page-title d-flex"},[a("h4",[a("i",{staticClass:"mr-2",class:t.titleIcon}),t._v(" "),a("span",{staticClass:"font-weight-semibold"},[t._v(t._s(t.title))]),t._v(" "),a("small",{staticClass:"d-block text-muted"},[t._v(t._s(t.titleDesc))])])]),t._v(" "),a("div",{staticClass:"header-elements d-none py-0 mb-3 mb-md-0"},[1===t.level?a("div",{staticClass:"breadcrumb"},[a("router-link",{staticClass:"breadcrumb-item",attrs:{to:{name:"dashboard"}}},[a("i",{staticClass:"icon-home4"}),t._v("  Dashboard ")]),t._v(" "),a("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.title))])],1):t._e(),t._v(" "),2===t.level?a("div",{staticClass:"breadcrumb"},[a("router-link",{staticClass:"breadcrumb-item",attrs:{to:{name:"dashboard"}}},[a("i",{staticClass:"icon-home4"}),t._v(" Dashboard ")]),t._v(" "),a("a",{staticClass:"breadcrumb-item",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.level2Back()}}},[t._v(t._s(t.level2Title))]),t._v(" "),a("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.title))])],1):t._e(),t._v(" "),3===t.level?a("div",{staticClass:"breadcrumb"},[t._t("breadcrumb")],2):t._e()])])])])}),[],!1,null,null,null);e.a=o.exports},b2K9:function(t,e,a){"use strict";a.r(e);var s=a("L2JU"),i=a("Ll3F"),r=a("8MVx"),n=a("IIPP"),l=a.n(n),o=a("vDqi"),c=a.n(o);function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var p={props:{title:{type:String}},data:function(){return{message:null,files:[],stat:"",count:"",progress:[],progressBar:0,isLoading:!1,submited:!1,isClicked:!1}},methods:{submit:function(t){var e=this;this.isLoading=!0;for(var a=0;a<this.files.length;a++){var s=new FormData;s.append("file",this.files[a]),s.append("id_cu",this.currentUser.id_cu),s.append("id_user",this.currentUser.id),s.append("file_name",this.title),c.a.post("/api/fileUpload/store",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.progressBar=parseInt(Math.round(100*t.loaded/t.total))}.bind(this)}).then((function(t){200==t.status&&e.$store.commit("fileUpload/setDataS",t.data.model),setTimeout((function(){e.$emit("LoadingStat",e.isLoading),e.message=t.data.message,e.progressBar=0,e.reset(),e.files=[]}))}))}},reset:function(){this.$refs.file.value=""},click:function(){this.isClicked=!0,this.$emit("fileBatal",this.title)},upload:function(t){this.isClicked=!1,this.files=[],this.message=null,this.files.push(t.files[0]),this.$emit("fileSelected",{file:this.files,name:this.title})}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){d(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(s.b)("auth",{currentUser:"currentUser"}))},h=a("KHd+"),f=Object(h.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",{attrs:{action:"javascript:void(0)",enctype:"multipart/form-data",method:"post"}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header bg-white"},[a("h5",{staticClass:"card-title"},[t._v(t._s(this.title))])]),t._v(" "),a("div",{staticClass:"card-body"},[t.message?a("div",{staticClass:"alert alert-success"},[t._v(t._s(t.message))]):t._e(),t._v(" "),a("input",{ref:"file",staticClass:"form-control",attrs:{type:"file",accept:".csv,.xlsx,.xls",name:"file"},on:{click:t.reset,change:function(e){return t.upload(e.target)}}}),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar",style:{width:t.progressBar+"%"},attrs:{role:"progressbar","aria-valuenow":t.progressBar,"aria-valuemin":"0","aria-valuemax":"100"}},[t._v(t._s(t.progressBar)+"%")])]),t._v(" "),a("input",{staticClass:"btn btn-danger btn-block btn-sm",staticStyle:{"margin-top":"5px"},attrs:{disabled:t.files.length<=0||t.isClicked,type:"button",value:"BATAL"},on:{click:[t.click,function(e){return e.preventDefault(),t.reset.apply(null,arguments)}]}})])])])}),[],!1,null,null,null).exports;function m(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var v={components:{pageHeader:i.a,appModal:r.a,Cleave:l.a,singleFileUpload:f},data:function(){return{isLoading:!0,selectedItem:null,title:"Import ESCETE",titleDesc:"Melakukan upload data CSV ESCETE",titleIcon:"icon-file-upload2",kelas:"testUpload",loadingCount:[],files:[],fileCounter:0,modalShow:!1,isDraft:!1,flagRekening:!1,flagAnggota:!1,flagProduk:!1,modalState:"",modalTitle:"",modalColor:"",modalContent:"",modalSize:""}},watch:{loadingCount:function(){0!=this.loadingCount.length&&this.loadingCount.length==this.fileCounter&&(this.files=[],this.loadingCount=[],this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu,this.currentUser.id]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]))},uploadStat:function(t){this.modalShow=!0,this.modalState=t,this.modalColor="","success"==t?(this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]),this.modalTitle=this.uploadResponse.message):(this.modalTitle="Oops terjadi kesalahan :(",this.modalContent=this.uploadResponse)},updateStat:function(t){this.modalShow=!0,this.modalState=t,this.modalColor="","success"==t?(this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]),this.modalTitle=this.updateResponse.message):(this.modalTitle="Oops terjadi kesalahan :(",this.modalContent=this.updateResponse)},files:function(){0==this.files.length&&(this.isLoading=!0)},tipe:function(){"single"==this.tipe?this.cekTipe=!0:this.cekTipe=!1}},created:function(){this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu,this.currentUser.id]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id])},methods:{modalOpen:function(t,e,a){this.modalShow=!0,this.state=t,e&&(this.selectedItem=a),"hapus"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="Hapus file "+this.selectedItem.file_name+"?",this.modalButton="Iya, Hapus"),"upload_draft"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="Upload file ke draft?",this.modalButton="Upload"),"simpan_draft"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="simpan draft?",this.modalButton="Upload")},modalConfirmOk:function(){this.modalShow=!1,"hapus"==this.state&&this.$store.dispatch("fileUpload/destroy",this.selectedItem.id),"upload_draft"==this.state&&this.$store.dispatch("anggotaCuImportEscete/draft",[this.currentUser.id_cu,this.currentUser.id]),"simpan_draft"==this.state&&this.$store.dispatch("anggotaCuImportEscete/simpanDraft",this.currentUser.id_cu)},modalTutup:function(){this.modalShow=!1},modalBackgroundClick:function(){"success"==this.modalState?this.modalTutup:"loading"==this.modalState||(this.modalShow=!1),this.isDisableTablePeserta=!1},submit:function(){this.loadingCount=[],this.isLoading=!0,console.log("ya"),1==this.flagProduk&&this.$refs.formProduk.submit(),1==this.flagAnggota&&this.$refs.formAnggota.submit(),1==this.flagRekening&&this.$refs.formRekening.submit()},setLoadingStat:function(t){this.loadingCount.push(t)},setFileCount:function(t){this.isLoading=!1,0==this.flagAnggota&&"DATA_ANGGOTA"==t.name?(this.flagAnggota=!0,this.fileCounter++):0==this.flagRekening&&"DATA_REKENING"==t.name?(this.flagRekening=!0,this.fileCounter++):0==this.flagProduk&&"DATA_PRODUK"==t.name&&(this.flagProduk=!0,this.fileCounter++);var e={name:t.name,file:t.file};this.files.push(e)},remove:function(t){1==this.flagAnggota&&"DATA_ANGGOTA"==t?(this.flagAnggota=!1,this.fileCounter--):1==this.flagRekening&&"DATA_REKENING"==t?(this.flagRekening=!1,this.fileCounter--):1==this.flagProduk&&"DATA_PRODUK"==t&&(this.flagProduk=!1,this.fileCounter--);var e=this.files.map((function(t){return t.name})).indexOf(t);this.files.splice(e,1)},setSelectedItem:function(t){this.selectedItem=t},SimpanDraft:function(){}},computed:b(b(b(b({},Object(s.b)("auth",{currentUser:"currentUser"})),Object(s.b)("anggotaCuImportEscete",{uploadResponse:"update",uploadStat:"updateStat",Draft:"isDraft"})),Object(s.b)("fileUpload",{dataS:"dataS",updateResponse:"update",updateStat:"updateStat"})),Object(s.b)("cu",{modelCU:"headerDataS",modelCUStat:"headerDataStatS"}))},_=Object(h.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-header",{attrs:{title:t.title,titleDesc:t.titleDesc,titleIcon:t.titleIcon}}),t._v(" "),a("div",{staticClass:"page-content pt-0"},[a("div",{staticClass:"content-wrapper"},[a("div",{staticClass:"content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("singleFileUpload",{ref:"formAnggota",attrs:{title:"DATA_ANGGOTA"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_ANGGOTA")}}}),t._v(" "),a("singleFileUpload",{ref:"formRekening",attrs:{title:"DATA_REKENING"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_REKENING")}}}),t._v(" "),a("singleFileUpload",{ref:"formProduk",attrs:{title:"DATA_PRODUK"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_PRODUK")}}})],1),t._v(" "),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card card-body"},[a("input",{staticClass:"btn btn-primary ",attrs:{disabled:t.isLoading,type:"button",value:"Upload"},on:{click:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}})])]),t._v(" "),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body"},[a("div",{staticClass:"row"},[t._l(t.dataS,(function(e,s){return a("div",{key:s,staticClass:"col-md-4"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("h5",{staticClass:"card-title"},[t._v(t._s(e.tipe))]),t._v(" "),a("h5",{staticClass:"card-title"},[t._v(t._s(e.file_name))]),t._v(" "),a("input",{staticClass:"btn btn-danger ",attrs:{type:"button",value:"HAPUS"},on:{click:[function(a){return a.preventDefault(),t.setSelectedItem(e)},function(e){return e.preventDefault(),t.modalOpen("hapus")}]}})])])])})),t._v(" "),t.dataS.length<=0?a("div",{staticClass:"col-sm-12"},[t._v("File upload tidak ditemukan")]):t._e()],2)])])]),t._v(" "),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card card-body"},[0!=t.currentUser.id_cu?a("input",{staticClass:"btn btn-warning mb-2",attrs:{disabled:t.dataS.length<=0,type:"button",value:"Upload Ke Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("upload_draft")}}}):t._e(),t._v(" "),0==t.currentUser.id_cu?a("input",{staticClass:"btn btn-warning mb-2",attrs:{type:"button",value:"Upload Ke Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("upload_draft")}}}):t._e(),t._v(" "),a("input",{staticClass:"btn btn-success mb-2",attrs:{disabled:!t.Draft,type:"button",value:"Simpan Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("simpan_draft")}}})])])])])])]),t._v(" "),a("app-modal",{attrs:{show:t.modalShow,state:t.modalState,title:t.modalTitle,content:t.modalContent,size:t.modalSize,color:t.modalColor},on:{batal:t.modalTutup,tutup:t.modalTutup,confirmOk:t.modalConfirmOk,successOk:t.modalTutup,failOk:t.modalTutup,backgroundClick:t.modalBackgroundClick}},[a("template",{slot:"modal-title"},[t._v("\n\t\t\t\t"+t._s(t.modalTitle)+"\n\t\t\t")])],2)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header bg-white"},[e("h5",{staticClass:"card-title"},[this._v("List File")])])}],!1,null,null,null);e.default=_.exports}}]);